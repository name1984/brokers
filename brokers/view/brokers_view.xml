<?xml version="1.0" encoding="UTF-8"?>
<openerp>
  <data>

    <menuitem id="menu_main_brokers" name="Pólizas y Seguros"/>
    <menuitem id="menu_main_seguros" name="Seguros" parent="menu_main_brokers"/>
    <menuitem id="menu_main_policies" name="Pólizas" parent="menu_main_brokers"/>
    <menuitem id="menu_main_configuration" name="Configuración" parent="menu_main_brokers"/>

    <record id="view_insurance_insurance_form" model="ir.ui.view">
      <field name="name">view.insurance.insurance.form</field>
      <field name="model">insurance.insurance</field>
      <field name="arch" type="xml">
	<form string="Gestión de Seguros" version="7.0">
	  <header>
	    <field name="state" widget="statusbar" statusbar_visible="draft,request,ok"/>
	  </header>
	  <sheet string="Seguro de Desgravamen">
            <div class="oe_title">
              <h2>
		<label string="Canal: " for="contractor_id"/>
		<field name="contractor_id" readonly="1" class="oe_inline" options="{'no_open': True}"/>
	      </h2>
	      <h2>
                <label string="Solicitud de Seguro" attrs="{'invisible': ['|',('state','&lt;&gt;','draft')]}"/>
                <field name="name" class="oe_inline"  attrs="{'invisible': [('state', '=', 'draft')]}"/>
	      </h2>
	    </div>
	    <group string="Registro Deudor">
	      <field name="deudor_id"/>
	    </group>
	    <group>
	      <group string="Datos Solicitud de Crédito">
		<field name="city_id"/>
		<field name="date" required="1"/>
		<field name="account_number"/>
		<field name="nro_operacion_credito"/>
		<field name="plazo"/>
	      </group>
	      <group string="Datos Créditos Vigentes">
		<field name="has_active_credit"/>
		<group class="oe_subtotal_footer oe_right">
		  <field name="total_active_credits" widget="monetary"/>
		  <field name="monto_credito_solicitado" widget="monetary"/>
		  <field name="total_credits" class="oe_subtotal_footer_separator" widget="monetary"/>
		</group>
	      </group>
	    </group>
	  </sheet>
          <div class="oe_chatter">
            <field name="message_follower_ids" widget="mail_followers" 
		   help="Seguir este trámite para recibir notificaciones de eventos asociados." groups="base.group_user"/>
            <field name="message_ids" widget="mail_thread"/>
          </div>
	</form>
      </field>
    </record>

    <record id="view_insurance_insurance_tree" model="ir.ui.view">
      <field name="name">view.insurance.insurance.tree</field>
      <field name="model">insurance.insurance</field>
      <field name="arch" type="xml">
	<tree string="Seguros de Desgravamen" colors="blue:state == 'draft';black:state in ('done');gray:state == 'cancel'">
	  <field name="name"/>
	  <field name="contractor_id"/>
	  <field name="deudor_id"/>
	  <field name="total_credits"/>
	</tree>
      </field>
    </record>

    <record id="view_insurance_insurance_search" model="ir.ui.view">
      <field name="name">view.insurance.insurance.search</field>
      <field name="model">insurance.insurance</field>
      <field name="arch" type="xml">
	<search string="Gestión de Seguros de Desgravamen">
	  <field name="name"/>
	  <field name="deudor_id"/>
	  <field name="total_credits"/>
	</search>
      </field>
    </record>

    <record id="action_insurance_insurance" model="ir.actions.act_window">
      <field name="name">Seguros Desgravamen</field>
      <field name="res_model">insurance.insurance</field>
      <field name="view_type">form</field>
      <field name="view_mode">tree,form</field>
    </record>

    <menuitem action="action_insurance_insurance" id="menu_seguros_desgravamen" name="Seguros Desgravamen" parent="menu_main_seguros"/>


    <!--
	Canal de distribucion en el usuario
    -->
    <record id="view_res_users_contractor" model="ir.ui.view">
      <field name="">view.res.users.contractor</field>
      <field name="model">res.users</field>
      <field name="inherit_id" ref="base.view_users_form"/>
      <field name="arch" type="xml">
	<field name="company_id" position="after">
	  <field name="contractor_id"/>
	</field>
      </field>
    </record>

    <record id="view_res_partner_insurance_form" model="ir.ui.view">
      <field name="name">view.res.partner.insurance.form</field>
      <field name="model">insurance.partner</field>
      <field name="arch" type="xml">
	<form string="Información Deudor" version="7.0">
	  <sheet string="Información Deudor">
	    <label for="name" class="oe_edit_only" string="Nombres Completos"/>
	    <h1>
	      <field name="name" class="oe_inline" placeholder="Nombres"/>
	      <field name="last_name" class="oe_inline" placeholder="Apellidos"/>
	    </h1>
	    <label for="tipo_identificador" string="Identificador"/>
	    <h3>
	      <field name="tipo_identificador" class="oe_inline"/>
	      <field name="identificador" class="oe_inline" placeholder="Cédula / RUC"/>
	    </h3>
	    <group string="Información">
	      <group>
		<field name="birth_date"/>
		<field name="sexo"/>
		<field name="civil_id"/>
	      </group>
	      <group>
		<field name="mobile"/>
		<field name="phone"/>
		<field name="email"/>
		<field name="street" placeholder="Calle principal"/>
	      </group>
	    </group>
	  </sheet>
	</form>
      </field>
    </record>

    <record id="view_insurance_policy_form" model="ir.ui.view">
      <field name="name">view.insurance.policy.form</field>
      <field name="model">insurance.policy</field>
      <field name="arch" type="xml">
	<form string="Póliza de Seguro" version="7.0">
	  <sheet string="Póliza de Seguro">
	    <h2>
	      <field name="name"/>	      
	    </h2>
	    <group string="Información">
	      <field name="partner_id" domain="[('customer','=',True)]"/>
	      <field name="aseguradora_id" domain="[('supplier','=',True)]"/>
	    </group>
	  </sheet>
	</form>
      </field>
    </record>

    <record id="view_insurance_policy_tree" model="ir.ui.view">
      <field name="name">view.insurance.policy.tree</field>
      <field name="model">insurance.policy</field>
      <field name="arch" type="xml">
	<tree string="Pólizas de Seguro">
	  <field name="name"/>
	  <field name="partner_id"/>
	  <field name="aseguradora_id"/>
	</tree>
      </field>
    </record>
    
    <record id="view_insurance_policy_search" model="ir.ui.view">
      <field name="name">view.insurance.policy.search</field>
      <field name="model">insurance.policy</field>
      <field name="arch" type="xml">
	<search>
	  <field name="name"/>
	  <field name="partner_id"/>
	  <field name="aseguradora_id"/>
	</search>
      </field>
    </record>

    <record id="action_insurance_policy" model="ir.actions.act_window">
      <field name="name">Pólizas</field>
      <field name="res_model">insurance.policy</field>
      <field name="view_type">form</field>
      <field name="view_mode">tree,form</field>
    </record>

    <menuitem action="action_insurance_policy" id="menu_seguros_polizas" name="Pólizas" parent="menu_main_policies"/>

    <!-- Configuracion -->

    <record id="view_insurance_parameter_tree" model="ir.ui.view">
      <field name="name">view.insurance.parameter.tree</field>
      <field name="model">insurance.parameter</field>
      <field name="arch" type="xml">
	<tree string="Configuración de Valores por Póliza" editable="top">
	  <field name="policy_id"/>
	  <field name="partner_id"/>
	  <field name="amount_min"/>
	  <field name="amount_max1"/>
	  <field name="amount_max2"/>
	</tree>
      </field>
    </record>

    <record id="view_insurance_parameter_search" model="ir.ui.view">
      <field name="name">view.insurance.parameter.search</field>
      <field name="model">insurance.parameter</field>
      <field name="arch" type="xml">
	<search>
	  <field name="policy_id"/>
	  <field name="partner_id"/>
	</search>
      </field>
    </record>

    <record id="action_insurance_parameter" model="ir.actions.act_window">
      <field name="name">Montos por Póliza</field>
      <field name="res_model">insurance.parameter</field>
      <field name="view_type">form</field>
      <field name="view_mode">tree</field>
    </record>

    <menuitem action="action_insurance_parameter" id="menu_amount_conf" name="Montos por Póliza" parent="menu_main_configuration"/>

  </data>
</openerp>
